---
layout: post
title: 设计模式学习笔记
categories: design-patterns
description: 设计模式学习笔记
keywords: design-patterns
excerpt: design-patterns Notebook
---

# 结构型模式
这类模式介绍如何将对象和类组装成较大的结构， 并同时保持结构的灵活和高效。
##  代理模式

### 为何需要
假设有一个消耗大量系统资源的巨型对象， 但我们只是偶尔需要使用它， 并非总是需要。此时可以选择延迟初始化，在实际有需要时再创建该对象。 但是这样的话使用该对象的所有客户端都要执行延迟初始代码，可能会带来很多重复代码。

还有一种情况是，有时可能需要加入一些额外的代码到对象的类里，但这并非总是能实现： 比如类可能是第三方封闭库的一部分。

### 解决方案
代理模式指的是新建一个与原服务对象**接口相同**的代理类，然后让客户端来使用这个代理类的对象，而不直接使用原对象。代理类接收到客户端请求后会创建实际的服务对象， 并将所有工作委派给它。

![](/images/blog/proxy.png)

### 适合应用场景
1. 延迟初始化（虚拟代理）
2. 访问控制（保护代理）。可以在代理类中加入身份验证代码，使代理仅在客户端凭据满足要求时将请求传递给服务对象
3. 本地执行远程服务（远程代理）。在这种情形中，代理通过网络传递客户端请求， 负责处理所有与网络相关的复杂细节。
4. 记录日志请求（日志记录代理）。代理可以在向服务传递请求前进行记录。
5. 缓存请求结果（缓存代理）。代理可对重复请求所需的相同结果进行缓存， 还可使用请求参数作为索引缓存的键值。

### 优点
开闭原则。 你可以在不对服务或客户端做出修改的情况下创建新代理。

即使服务对象还未准备好或不存在， 代理也可以正常工作。

如果客户端对服务对象的生命周期没有特殊要求， 你可以对生命周期进行管理。

### 缺点
代码可能会变得复杂， 因为需要新建许多类。

服务响应可能会延迟。